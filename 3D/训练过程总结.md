# C3D 训练







# P3D训练

## P3D论文思想



## 训练过程记录

（1）数据输入的两种方式，video和image

（2）伪三维卷积的网络结构文件目录 “/home/liye/P3D/examples/p3d_ucf101_training/P3D50_ucf101.prototxt”

- 该网络结构由Res50修改得到，目的是为了用Res50进行网络权重初始化

- 在

（3）修改caffe源码，实现Res50中1 * 1 的卷积核参数初始化1 * 1 * 1 卷积核。

- 在P3D版本的caffe基础上，修改文件“/home/liye/P3D/src/caffe/blob.cpp”

- 修改后的函数如下图所示：

![caffe源码修改](https://github.com/liyeUESTC/liye_project/blob/file_paper/images/%E5%9B%BE%E7%89%871.png)

- 实现Res50中1 * 1卷积核参数复制到P3D中1 * 1 * 1卷积核，实现Res中3 * 3卷积核参数复制到P3D中1 * 3 * 3卷积核，3 * 1 * 1卷积核权重没有复制，仍为随机初始化。 

- 参数复制过程如下图所示：

![](https://github.com/liyeUESTC/liye_project/blob/file_paper/images/%E5%9B%BE%E7%89%872.png)

(4)ucf101数据集划分

- 数据集的划分方式为ucf101的官网提供的三种划分方式的第一种，其划分python文件在247服务器下，

文件目录“/home/sfy/resnet50_project/ucf101_dataset_process.py”

- 目前只能给图像分类划分数据集，不能给视频分类划分数据集

（5）显卡显存问题

- 目前在247服务器上，两张tesla P4显卡，每张显卡7.6G显存

- 针对Res50网络，每张显卡可以设置训练batch_size=15，测试batch_size=3,即每张显卡batch_size=18，在此条件下，显存满足要求。用在imageNet上训练好的Res50网络，在数据集ucf101上进行finetuning，在迭代次数达到50000次时，准确率是73%，预测增加迭代次数可以提升准确率。

P3D论文中，Res50的准确率可以达到80.8%。

- 针对P3D50网络，网络结构为P3D50_ucf101.prototxt，对于每张显卡，length=16时，batch_size=1时，显存无法满足；length=4时，batch_size=1时，可以进行训练。




